
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>API Documentation &#8212; Kazu  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="TBA" href="training.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="training.html" title="TBA"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Kazu  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">API Documentation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-kazu.data.data">
<span id="api-documentation"></span><h1>API Documentation<a class="headerlink" href="#module-kazu.data.data" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="kazu.data.data.CharSpan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.data.data.</span></span><span class="sig-name descname"><span class="pre">CharSpan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.CharSpan" title="Permalink to this definition">¶</a></dt>
<dd><p>A concept similar to a Spacy Span, except is character index based rather than token based</p>
<dl class="py method">
<dt class="sig sig-object py" id="kazu.data.data.CharSpan.is_completely_overlapped">
<span class="sig-name descname"><span class="pre">is_completely_overlapped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.CharSpan.is_completely_overlapped" title="Permalink to this definition">¶</a></dt>
<dd><p>True if other completely overlaps this span
:param other:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.data.data.CharSpan.is_partially_overlapped">
<span class="sig-name descname"><span class="pre">is_partially_overlapped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.CharSpan.is_partially_overlapped" title="Permalink to this definition">¶</a></dt>
<dd><p>True if other partially overlaps this span
:param other:
:return:</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.data.data.Entity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.data.data.</span></span><span class="sig-name descname"><span class="pre">Entity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">match:</span> <span class="pre">str,</span> <span class="pre">entity_class:</span> <span class="pre">str,</span> <span class="pre">spans:</span> <span class="pre">~typing.FrozenSet[~kazu.data.data.CharSpan],</span> <span class="pre">namespace:</span> <span class="pre">str,</span> <span class="pre">mappings:</span> <span class="pre">~typing.List[~kazu.data.data.Mapping]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">hits:</span> <span class="pre">~typing.List[~kazu.data.data.Hit]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">metadata:</span> <span class="pre">~typing.Dict[~typing.Any,</span> <span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.Entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic data class representing a unique entity in a string. Note, since an entity can consist of multiple CharSpan,
we have to define the semantics of overlapping spans.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kazu.data.data.Entity.add_mapping">
<span class="sig-name descname"><span class="pre">add_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#kazu.data.data.Mapping" title="kazu.data.data.Mapping"><span class="pre">Mapping</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.Entity.add_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>deprecated
:param mapping:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.data.data.Entity.as_brat">
<span class="sig-name descname"><span class="pre">as_brat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.Entity.as_brat" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>self as the third party biomedical nlp Brat format, (see docs on Brat)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.data.data.Entity.from_spans">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_spans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.Entity.from_spans" title="Permalink to this definition">¶</a></dt>
<dd><p>create an instance of Entity from a list of character indices. A text string of underlying doc is
also required to produce a representative match
:param spans:
:param text:
:param join_str: a string used to join the spans together
:param kwargs:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.data.data.Entity.is_completely_overlapped">
<span class="sig-name descname"><span class="pre">is_completely_overlapped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.Entity.is_completely_overlapped" title="Permalink to this definition">¶</a></dt>
<dd><p>True if all CharSpan instances are completely encompassed by all other CharSpan instances
:param other:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.data.data.Entity.is_partially_overlapped">
<span class="sig-name descname"><span class="pre">is_partially_overlapped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.Entity.is_partially_overlapped" title="Permalink to this definition">¶</a></dt>
<dd><p>True if only one CharSpan instance is defined in both self and other, and they are partially overlapped</p>
<p>If multiple CharSpan are defined in both self and other, this becomes pathological, as while they may overlap
in the technical sense, they may have distinct semantic meaning. For instance, consider the case where
we may want to use is_partially_overlapped to select the longest annotation span suggested
by some NER system.</p>
<p>case 1:
text: the patient has metastatic liver cancers
entity1:  metastatic liver cancer -&gt; [CharSpan(16,39]
entity2: liver cancers -&gt; [CharSpan(27,40]</p>
<p>result: is_partially_overlapped -&gt; True (entities are part of same concept)</p>
<p>case 2: non-contiguous entities</p>
<p>text: lung and liver cancer
lung cancer -&gt; [CharSpan(0,4), CharSpan(1521
liver cancer -&gt; [CharSpan(9,21)]</p>
<p>result: is_partially_overlapped -&gt; False (entities are distinct)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.data.data.Mapping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.data.data.</span></span><span class="sig-name descname"><span class="pre">Mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_label:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser_name:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence:</span> <span class="pre">~kazu.data.data.LinkRanks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping_type:</span> <span class="pre">~typing.FrozenSet[str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata:</span> <span class="pre">~typing.Dict[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.data.Mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>a mapping is a fully mapped and disambiguated kb concept</p>
</dd></dl>

<span class="target" id="module-kazu.data.pytorch"></span><dl class="py class">
<dt class="sig sig-object py" id="kazu.data.pytorch.HFDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.data.pytorch.</span></span><span class="sig-name descname"><span class="pre">HFDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encodings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BatchEncoding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.pytorch.HFDataset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kazu.data.pytorch.HFDataset.reinforce_type">
<span class="sig-name descname"><span class="pre">reinforce_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.data.pytorch.HFDataset.reinforce_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Reinforce the type for DataPipe instance. And the ‘expected_type’ is required
to be a subtype of the original type hint to restrict the type requirement
of DataPipe instance.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-kazu.modelling.hf_lightning_wrappers"></span><dl class="py class">
<dt class="sig sig-object py" id="kazu.modelling.hf_lightning_wrappers.PLAutoModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.modelling.hf_lightning_wrappers.</span></span><span class="sig-name descname"><span class="pre">PLAutoModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AutoModel</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.modelling.hf_lightning_wrappers.PLAutoModel" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kazu.modelling.hf_lightning_wrappers.PLAutoModel.predict_step">
<span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#kazu.modelling.hf_lightning_wrappers.PLAutoModel.predict_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Step function called during <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code>. By default, it
calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code>. Override to add any processing
logic.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_step()</span></code> is used
to scale inference on multi-devices.</p>
<p>To prevent an OOM error, it is possible to use <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code>
callback to write the predictions to disk or database after each batch or on epoch end.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code> should be used while using a spawn
based accelerator. This happens for <code class="docutils literal notranslate"><span class="pre">Trainer(strategy=&quot;ddp_spawn&quot;)</span></code>
or training on 8 TPU cores with <code class="docutils literal notranslate"><span class="pre">Trainer(tpu_cores=8)</span></code> as predictions won’t be returned.</p>
<p>Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">predicts_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="n">dm</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><p>batch: Current batch
batch_idx: Index of current batch
dataloader_idx: Index of the current dataloader</p>
</dd>
<dt>Return:</dt><dd><p>Predicted output</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.modelling.hf_lightning_wrappers.PLAutoModelForTokenClassification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.modelling.hf_lightning_wrappers.</span></span><span class="sig-name descname"><span class="pre">PLAutoModelForTokenClassification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AutoModelForTokenClassification</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.modelling.hf_lightning_wrappers.PLAutoModelForTokenClassification" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kazu.modelling.hf_lightning_wrappers.PLAutoModelForTokenClassification.predict_step">
<span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#kazu.modelling.hf_lightning_wrappers.PLAutoModelForTokenClassification.predict_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Step function called during <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code>. By default, it
calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code>. Override to add any processing
logic.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_step()</span></code> is used
to scale inference on multi-devices.</p>
<p>To prevent an OOM error, it is possible to use <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code>
callback to write the predictions to disk or database after each batch or on epoch end.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code> should be used while using a spawn
based accelerator. This happens for <code class="docutils literal notranslate"><span class="pre">Trainer(strategy=&quot;ddp_spawn&quot;)</span></code>
or training on 8 TPU cores with <code class="docutils literal notranslate"><span class="pre">Trainer(tpu_cores=8)</span></code> as predictions won’t be returned.</p>
<p>Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">predicts_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="n">dm</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><p>batch: Current batch
batch_idx: Index of current batch
dataloader_idx: Index of the current dataloader</p>
</dd>
<dt>Return:</dt><dd><p>Predicted output</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-kazu.pipeline.pipeline"></span><dl class="py class">
<dt class="sig sig-object py" id="kazu.pipeline.pipeline.FailedDocsFileHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">FailedDocsFileHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.pipeline.pipeline.FailedDocsFileHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>implementation logs docs to a directory, along with exception message</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.pipeline.pipeline.FailedDocsHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">FailedDocsHandler</span></span><a class="headerlink" href="#kazu.pipeline.pipeline.FailedDocsHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>class to somehow handle failed docs</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.pipeline.pipeline.FailedDocsLogHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">FailedDocsLogHandler</span></span><a class="headerlink" href="#kazu.pipeline.pipeline.FailedDocsLogHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>implementation that logs to warning</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kazu.pipeline.pipeline.load_steps">
<span class="sig-prename descclassname"><span class="pre">kazu.pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">load_steps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DictConfig</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">BaseStep</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.pipeline.pipeline.load_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>loads steps based on the cfg.pipeline</p>
</dd></dl>

<span class="target" id="module-kazu.steps"></span><span class="target" id="module-kazu.steps.linking.link_ensembling"></span><p>DEPRECATED</p>
<dl class="py class">
<dt class="sig sig-object py" id="kazu.steps.linking.link_ensembling.MappingPostProcessing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.steps.linking.link_ensembling.</span></span><span class="sig-name descname"><span class="pre">MappingPostProcessing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#kazu.data.data.Entity" title="kazu.data.data.Entity"><span class="pre">Entity</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">linker_score_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.steps.linking.link_ensembling.MappingPostProcessing" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensemble and resolve mapping information for an entity, according to a custom algorithm:
1) exact string match hit in ontology -&gt; High confidence
2) scores above threshold for a single linker -&gt; Medium-high confidence
3) different linkers suggest same ontology id -&gt; Medium-high confidence
4) matched text is contained in, or contains mapping default label or synonym -&gt; Medium confidence
5) best score overall, across all linkers -&gt; Low confidence</p>
<dl class="py method">
<dt class="sig sig-object py" id="kazu.steps.linking.link_ensembling.MappingPostProcessing.exact_hits">
<span class="sig-name descname"><span class="pre">exact_hits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#kazu.data.data.Mapping" title="kazu.data.data.Mapping"><span class="pre">Mapping</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.steps.linking.link_ensembling.MappingPostProcessing.exact_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>returns any perfect mappings - i.e. mappings where the match is the same as the default label, synonym, or linker
score is 100.0 (depends on linkers correctly normalising scores between 0-100). High confidence
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.steps.linking.link_ensembling.MappingPostProcessing.filter_scores">
<span class="sig-name descname"><span class="pre">filter_scores</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#kazu.data.data.Mapping" title="kazu.data.data.Mapping"><span class="pre">Mapping</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.steps.linking.link_ensembling.MappingPostProcessing.filter_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>do any of the mappings return a score above a threshold for a linker, to suggest a good mapping?
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.steps.linking.link_ensembling.MappingPostProcessing.query_contained_in_hits">
<span class="sig-name descname"><span class="pre">query_contained_in_hits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#kazu.data.data.Mapping" title="kazu.data.data.Mapping"><span class="pre">Mapping</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.steps.linking.link_ensembling.MappingPostProcessing.query_contained_in_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>is the match substring in any of the mappings, or vice versa? Medium confidence. Note, we only check
matches of 5 chars or more, otherwise will be noisy
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.steps.linking.link_ensembling.MappingPostProcessing.similarly_ranked">
<span class="sig-name descname"><span class="pre">similarly_ranked</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#kazu.data.data.Mapping" title="kazu.data.data.Mapping"><span class="pre">Mapping</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.steps.linking.link_ensembling.MappingPostProcessing.similarly_ranked" title="Permalink to this definition">¶</a></dt>
<dd><p>compare the results of all mapping id’s between linkers via set.intersection. Return any that all linkers agree
on, sorted by score
:return:</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-kazu.utils.caching"></span><dl class="py class">
<dt class="sig sig-object py" id="kazu.utils.caching.EntityLinkingLookupCache">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.utils.caching.</span></span><span class="sig-name descname"><span class="pre">EntityLinkingLookupCache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lookup_cache_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.caching.EntityLinkingLookupCache" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple wrapper around LFUCache to reduce calls to expensive processes (e.g. bert)</p>
<dl class="py method">
<dt class="sig sig-object py" id="kazu.utils.caching.EntityLinkingLookupCache.check_lookup_cache">
<span class="sig-name descname"><span class="pre">check_lookup_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#kazu.data.data.Entity" title="kazu.data.data.Entity"><span class="pre">Entity</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#kazu.data.data.Entity" title="kazu.data.data.Entity"><span class="pre">Entity</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.caching.EntityLinkingLookupCache.check_lookup_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>checks the cache for mappings and hits. If relevant mappings are found for an entity, update its mappings
accordingly. If not return as a list of cache misses (e.g. for further processing)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>entities</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-kazu.utils.link_index"></span><dl class="py class">
<dt class="sig sig-object py" id="kazu.utils.link_index.CDistTensorEmbeddingIndex">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.utils.link_index.</span></span><span class="sig-name descname"><span class="pre">CDistTensorEmbeddingIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OntologyParser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.CDistTensorEmbeddingIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate embedding based on cosine distance</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.utils.link_index.DictionaryIndex">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.utils.link_index.</span></span><span class="sig-name descname"><span class="pre">DictionaryIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OntologyParser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.DictionaryIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>a simple dictionary index for linking. Uses a Dict[str, List[SynonymData]] for matching synonyms,
with optional fuzzy matching. Note, since a given synonym can match to more than one metadata entry (even
within the same knowledgebase), we have a pathological situation in which ‘true’ synonyms can not be said to
exist. In such situations, we return multiple kb references for overloaded synonyms - i.e. the disambiguation is
delegated elsewhere</p>
<dl class="py method">
<dt class="sig sig-object py" id="kazu.utils.link_index.DictionaryIndex.search">
<span class="sig-name descname"><span class="pre">search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Hit</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.link_index.DictionaryIndex.search" title="Permalink to this definition">¶</a></dt>
<dd><p>search the index
:param query: a string of text
:return: Iterable of Tuple [kb.id, metadata_dict]</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.utils.link_index.EmbeddingIndex">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.utils.link_index.</span></span><span class="sig-name descname"><span class="pre">EmbeddingIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OntologyParser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ontology_partition_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.EmbeddingIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>a wrapper around an embedding index strategy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kazu.utils.link_index.EmbeddingIndex.enumerate_database_chunks">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">enumerate_database_chunks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.link_index.EmbeddingIndex.enumerate_database_chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>generator to split up a dataframe into partitions
:param name: ontology name to query the metadata database with
:param chunk_size: size of partittions to create
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.utils.link_index.EmbeddingIndex.predict_ontology_embeddings">
<span class="sig-name descname"><span class="pre">predict_ontology_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.link_index.EmbeddingIndex.predict_ontology_embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>since embeddings are memory hungry, we use a generator to partition an input dataframe into manageable chucks,
and add them to the index sequentially
:param name: name of ontology
:return: partition number, metadata and embeddings</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.utils.link_index.Index">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.utils.link_index.</span></span><span class="sig-name descname"><span class="pre">Index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OntologyParser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.Index" title="Permalink to this definition">¶</a></dt>
<dd><p>base class for all indices.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kazu.utils.link_index.Index.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.Index.add" title="Permalink to this definition">¶</a></dt>
<dd><p>add data to the index
:param data:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.utils.link_index.Index.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cache_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.Index.load" title="Permalink to this definition">¶</a></dt>
<dd><p>load from disk
:param path: the parent path of the index
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.utils.link_index.Index.load_or_build_cache">
<span class="sig-name descname"><span class="pre">load_or_build_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_rebuild_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.Index.load_or_build_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>for each parser in self.parsers, create an index. If a cached version is available, load it instead
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kazu.utils.link_index.Index.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="headerlink" href="#kazu.utils.link_index.Index.save" title="Permalink to this definition">¶</a></dt>
<dd><p>save to disk. Makes a directory at the path location with all the index assets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a Path to where the index was saved</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.utils.link_index.MatMulTensorEmbeddingIndex">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.utils.link_index.</span></span><span class="sig-name descname"><span class="pre">MatMulTensorEmbeddingIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OntologyParser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.MatMulTensorEmbeddingIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate embedding based on MatMul</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kazu.utils.link_index.TensorEmbeddingIndex">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.utils.link_index.</span></span><span class="sig-name descname"><span class="pre">TensorEmbeddingIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OntologyParser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.TensorEmbeddingIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>a simple index of torch tensors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kazu.utils.link_index.to_torch">
<span class="sig-prename descclassname"><span class="pre">kazu.utils.link_index.</span></span><span class="sig-name descname"><span class="pre">to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.link_index.to_torch" title="Permalink to this definition">¶</a></dt>
<dd><p>convert a sparse CSR matrix to a sparse torch matrix
:param matrix:
:param shape:
:return:</p>
</dd></dl>

<span class="target" id="module-kazu.utils.stopwatch"></span><span class="target" id="module-kazu.utils.utils"></span><dl class="py class">
<dt class="sig sig-object py" id="kazu.utils.utils.EntityClassFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kazu.utils.utils.</span></span><span class="sig-name descname"><span class="pre">EntityClassFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">required_entity_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kazu.utils.utils.EntityClassFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>A condition that returns True if a document has any entities that match the class of the required_entity_classes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kazu.utils.utils.create_char_ngrams">
<span class="sig-prename descclassname"><span class="pre">kazu.utils.utils.</span></span><span class="sig-name descname"><span class="pre">create_char_ngrams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.utils.create_char_ngrams" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of char ngrams as a string.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kazu.utils.utils.create_word_ngrams">
<span class="sig-prename descclassname"><span class="pre">kazu.utils.utils.</span></span><span class="sig-name descname"><span class="pre">create_word_ngrams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.utils.create_word_ngrams" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of word ngrams as a single space-separated string.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kazu.utils.utils.documents_to_document_section_batch_encodings_map">
<span class="sig-prename descclassname"><span class="pre">kazu.utils.utils.</span></span><span class="sig-name descname"><span class="pre">documents_to_document_section_batch_encodings_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Document</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AutoTokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">512</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">BatchEncoding</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Section</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.utils.documents_to_document_section_batch_encodings_map" title="Permalink to this definition">¶</a></dt>
<dd><p>convert documents into a BatchEncoding. Also returns a list of &lt;int + section&gt; for the resulting encoding</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>docs</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kazu.utils.utils.documents_to_document_section_text_map">
<span class="sig-prename descclassname"><span class="pre">kazu.utils.utils.</span></span><span class="sig-name descname"><span class="pre">documents_to_document_section_text_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Document</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.utils.documents_to_document_section_text_map" title="Permalink to this definition">¶</a></dt>
<dd><p>convert documents into a dict of &lt;dochash + sectionhash&gt;: text</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>docs</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kazu.utils.utils.documents_to_id_section_map">
<span class="sig-prename descclassname"><span class="pre">kazu.utils.utils.</span></span><span class="sig-name descname"><span class="pre">documents_to_id_section_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Document</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Section</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.utils.documents_to_id_section_map" title="Permalink to this definition">¶</a></dt>
<dd><p>return a map of documents, indexed by order of sections</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>docs</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kazu.utils.utils.filter_entities_with_ontology_mappings">
<span class="sig-prename descclassname"><span class="pre">kazu.utils.utils.</span></span><span class="sig-name descname"><span class="pre">filter_entities_with_ontology_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#kazu.data.data.Entity" title="kazu.data.data.Entity"><span class="pre">Entity</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#kazu.data.data.Entity" title="kazu.data.data.Entity"><span class="pre">Entity</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kazu.utils.utils.filter_entities_with_ontology_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>finds entities that have no kb mappings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>entities</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kazu.utils.utils.find_document_from_entity">
<span class="sig-prename descclassname"><span class="pre">kazu.utils.utils.</span></span><span class="sig-name descname"><span class="pre">find_document_from_entity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Document</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#kazu.data.data.Entity" title="kazu.data.data.Entity"><span class="pre">Entity</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Document</span></span></span><a class="headerlink" href="#kazu.utils.utils.find_document_from_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>for a given entity and a list of docs, find the doc the entity belongs to</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_map</strong> – </p></li>
<li><p><strong>entity</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-kazu.web.server"></span><dl class="py function">
<dt class="sig sig-object py" id="kazu.web.server.start">
<span class="sig-prename descclassname"><span class="pre">kazu.web.server.</span></span><span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DictConfig</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kazu.web.server.start" title="Permalink to this definition">¶</a></dt>
<dd><p>deploy the web app to Ray Serve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cfg</strong> – DictConfig from Hydra</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="training.html"
                          title="previous chapter">TBA</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/apidocs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="training.html" title="TBA"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Kazu  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">API Documentation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Korea University, AstraZeneca.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>